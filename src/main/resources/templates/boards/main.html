<!DOCTYPE html>
<page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<c:set var="cpath" value="${pageContext.request.contextPath}" />
<taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %>
<html xmlns xmlns:th="http://www.w3.org/1999/xhtml" : th="http://www.thymeleaf.org">
    <head>
        <link href="../css/main.css" rel="stylesheet" type="text/css" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
        <meta charset="UTF-8">
    </head>
    <body>
        <div class="container">
            <!-- 검색어 입력 받기 -->
            <br>
            <div class="container">
                <table class="float-left">
                    <tr>
                        <td>
                            <a>[[${memberId}]]님 환영합니다.</a>
                        </td>
                    </tr>
                    <tr>
                        <td style="display:inline-block">
                            <form th:action="@{chats}" method="get">
                                <input type="hidden" name="receiver" th:value="${memberId}">
                                <button class="btn-18" type="submit">MyChat</button>
                            </form>
                        </td>
                        <td style="display:inline-block">
                            <form th:action="@{logout}" method="get">
                                <button class="btn-18" type="submit">logout</button>
                            </form>    
                        </td>
                    </tr>
                </table>
            </div>
            <div class="container">
                <table class="float-right">
                    <tr>
                        <td><select class="form-control" name="searchField" id="searchField">
                            <option value="title">제목</option>
                            <option value="name">이름</option>
                        </select></td>
                        <td><input type="text" class="form-control"
                            placeholder="Search" id="searchWord" name="searchWord" ></td>
                        <td><button class="btn btn-primary pull-right" id="searchButton" type="button">
                            <span class="glyphicon glyphicon-search" id="search"></span>
                        </button></td>
                    </tr>            
                </table>
            </div>
            <br>
            <!-- 게시글 띄우기 -->
            <div class="container" id="container">
                <table class="table table-hover">
                    <thead>
                        <th style="text-align:center;">글번호</th>
                        <th style="text-align:center;">작성자</th>
                        <th style="text-align:center;">제목</th>
                        <th style="text-align:center;">조회수</th>
                    </thead>
                    <tr th:each="list :${list}">
                        <td style="text-align:center;">[[${list.boardId}]]</td>
                        <td style="width:100%; text-align:center;" class="writerName" th:value="${list.name}">
                            <input type="hidden" name="name" th:value="${list.name}">
                            [[${list.name}]]
                            <span class="tooltiptext">
                                <a class="specified">view | </a>
                                <a class="chat">chat</a>
                                <form th:action="chat" method="get">
                                    <button type="submit" style="display:none;" id="chat"></button>
                                    <input type="hidden" name="name" th:value="${list.name}">
                                    <input type="hidden" name="sender" th:value="${memberId}">
                                    <input type="hidden" name="receiver" th:value="${list.name}">
                                </form>
                            </span>
                        </td>
                        <td style="text-align:center;">
                            <a th:href="@{/board/view(boardId=${list.boardId})}">
                                [[${list.title}]]
                            </a>
                        </td>
                        <td style="text-align:center;">[[${list.read}]]
                            <button class="btn-17"><span class="glyphicon glyphicon-thumbs-up"></span></button>
                            <button class="btn-17"><span class="glyphicon glyphicon-thumbs-down"></span></button>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4" style="text-align:center" id="pageCount"></td>
                        <!-- 컨트롤러에서 넘겨준 변수인 pageCnt 를 script 에서 쓰려면 html 에서 먼저 받아 script 로 넘겨줘야 함 -->
                        <input type="hidden" id="pageCnt" th:value="${pageCnt}"> <!-- 총 페이지 수 -->
                        <input type="hidden" id="curRange" th:value="${curRange}"> <!-- 현재 블럭 -->
                        <input type="hidden" id="curPage" th:value="${curPage}"> <!-- 현재 페이지 -->
                        <input type="hidden" id="endPage" th:value="${endPage}"> <!-- 마지막 페이지 -->
                        <input type="hidden" id="endRange" th:value="${endRange}"> <!-- 마지막 블럭 -->
                    </tr>
                </table>
                <form th:action="@{upload}" method="get" style="display:inline-block">
                    <button type="submit" class="custom-btn btn-6">글쓰기</button>
                </form>
            </div>
        </div>
    </body>
    <script src="http://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script type="text/javascript">
        // 클릭한 작성자의 게시글 모아보기
        let specified = document.getElementsByClassName('specified');
        const specifiedBoard = (e) => {
            // 검색 메소드 차용
            let searchWord_to_put = $(e.target).parent().parent().children()[0].value;
            console.log("searchWord_to_put : "+searchWord_to_put);
            // 이름으로 검색하는 것과 같은 메소드 (searchField 에 name 이 들어감)
            let searchField = 'name';
            let searched_curPage = 1; // 검색된 게시글 현재 페이지
            let searched_curRange = 1; // 검색된 게시글 현재 블럭
            searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);
        }
        for(i=0;i<specified.length;i++) {
            specified[i].addEventListener('click',specifiedBoard);
        }

        // 채팅하기
        let chatBtn = document.getElementsByClassName('chat');
        const chatMethod = (e) => {
            $(e.target).parent().children()[2].children[0].click();
        }
        for(i=0;i<chatBtn.length;i++) {
            chatBtn[i].addEventListener('click',chatMethod);
        }

        // ajax 시작
        // 게시글 검색 버튼
        const searchTitleBtn = document.getElementById("search");
        const a = (e) => {
            // 사용자가 검색한 단어
            let searchWord_to_put = document.getElementById("searchWord").value;
            // 제목을 검색하면 title, 이름을 검색하면 name 이 searchField 에 들어감
            let searchField = document.getElementById("searchField").value;
            let searched_curPage = 1; // 검색된 게시글 현재 페이지
            let searched_curRange = 1; // 검색된 게시글 현재 블럭
            searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);
        }
        searchTitleBtn.addEventListener('click', a);
        
        // 게시글 검색 ajax 메소드
        function searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange){
            // 제목 검색
            if(searchField=='title') {
                let searchWord = {"searchWord":searchWord_to_put};
                $.ajax({
                    url:"/board/ajaxSearchTitle",
                    async : false,
                    type: "GET",
                    dataType: "json",
                    data: searchWord,
                    cache: false,
                    success: function (data){
                        let searched_listCnt = data.length; // 검색된 게시글 개수
                        let searched_pageSize = 10; // [검색한 게시글] 한 페이지당 검색된 게시글 수
                        let searched_pageCnt = Math.ceil(searched_listCnt*1.0/searched_pageSize); // [검색한 게시글] 총 페이지 수
                        let searched_endPage = searched_pageCnt; // [검색한 게시글] 마지막 페이지
                        let searched_rangeSize = 10; // [검색한 게시글] 한 블럭당 페이지 수
                        // [검색한 게시글] 총 블럭 수
                        let searched_rangeCnt = Math.ceil(searched_pageCnt*1.0/searched_rangeSize);
                        // [검색한 게시글] 마지막 블럭
                        let searched_endRange = searched_rangeCnt;
                        console.log(data);
                        ajaxMainHtml(data, searched_listCnt, searched_curPage, searched_pageSize, searched_pageCnt, searched_endPage, searched_curRange, searched_rangeSize, searched_rangeCnt, searched_endRange)
                    },
                    error: function(){alert("error");}
                });
            }
            // 작성자 검색
            else {               
                let searchWord = {"searchWord": searchWord_to_put};
                $.ajax({
                    url:"/board/ajaxSearchName",
                    async : false,
                    type: "GET",
                    dataType: "json",
                    data: searchWord,
                    cache: false,
                    success: function (data){
                        let searched_listCnt = data.length; // 검색된 게시글 개수
                        let searched_pageSize = 10; // [검색한 게시글] 한 페이지당 검색된 게시글 수
                        let searched_pageCnt = Math.ceil(searched_listCnt*1.0/searched_pageSize); // [검색한 게시글] 총 페이지 수
                        let searched_endPage = searched_pageCnt; // [검색한 게시글] 마지막 페이지
                        let searched_rangeSize = 10; // [검색한 게시글] 한 블럭당 페이지 수
                        // [검색한 게시글] 총 블럭 수
                        let searched_rangeCnt = Math.ceil(searched_pageCnt*1.0/searched_rangeSize);
                        // [검색한 게시글] 마지막 블럭
                        let searched_endRange = searched_rangeCnt;
                        console.log(data);
                        ajaxMainHtml(data, searched_listCnt, searched_curPage, searched_pageSize, searched_pageCnt, searched_endPage, searched_curRange, searched_rangeSize, searched_rangeCnt, searched_endRange)
                    },
                    error: function(){alert("error");}
                });
            }
        }
        function ajaxMainHtml(data, searched_listCnt, searched_curPage, searched_pageSize, searched_pageCnt, searched_endPage, searched_curRange, searched_rangeSize, searched_rangeCnt, searched_endRange){
            let mainHtml = '<table class="table table-hover">';
                mainHtml +='<input type="hidden" name="searched_endPage" id="searched_endPage">';
                mainHtml +='<thead>';
                    mainHtml +='<th style="text-align:center;">글번호</th>';
                    mainHtml +='<th style="text-align:center;">작성자</th>';
                    mainHtml +='<th style="text-align:center;">제목</th>';
                    mainHtml +='<th style="text-align:center;">조회수</th>';
                mainHtml +='</thead>';
                // [검색한 게시글] 타임리프 반복문으로 게시글 띄우기
                $.each(data, (index, list) => {
                    if (index >= ((searched_curPage-1)*10) && index < (searched_curPage*searched_pageSize)) {
                        mainHtml +='<tr>';
                        mainHtml +='<td style="text-align:center;">'+list.boardId+'</td>';
                        mainHtml +='<td style="width:100%; text-align:center;" class="writerName" value="'+list.name+'">';
                            mainHtml +='<input type="hidden" name="name" value="'+list.name+'">'+list.name;
                            mainHtml +='<span class="tooltiptext">';
                                mainHtml +='<a class="specified">view | </a>';
                                mainHtml +='<a class="chat"> chat</a>';
                            mainHtml +='</span>';
                        mainHtml +='</td>';
                        mainHtml +='<td style="text-align:center;">';
                            mainHtml +='<a href="/board/view?boardId='+list.boardId+'">';
                                mainHtml +=list.title;
                                mainHtml +='</a></td>';
                        mainHtml +='<td style="text-align:center;">'+list.read;
                            mainHtml +='<button class="btn-17"><span class="glyphicon glyphicon-thumbs-up"></span></button>';
                            mainHtml +='<button class="btn-17"><span class="glyphicon glyphicon-thumbs-down"></span></button>';
                        mainHtml +='</td>';
                    mainHtml +='</tr>';
                    }
                })
                mainHtml +='<tr>'; // 검색한 게시글 페이징 버튼 append 할 곳
                    mainHtml +='<td colspan="4" id="pageCount"></td>';
                mainHtml +='</tr>';
            mainHtml +='</table>';
            mainHtml +='<form action="upload" method="get" style="display:inline-block">';
                mainHtml +='<button type="submit" class="custom-btn btn-6">글쓰기</button>';
            mainHtml +='</form>';
            $("#container").html(mainHtml)

            // 작성자 게시글 모아보기
            let specified = document.getElementsByClassName('specified');
            const specifiedBoard = (e) => {
                // 검색 메소드 차용
                let searchWord_to_put = $(e.target).parent().parent().children()[0].value;
                // 이름으로 검색하는 것과 같은 메소드 (searchField 에 name 이 들어감)
                let searchField = 'name';
                let searched_curPage = 1; // 검색된 게시글 현재 페이지
                let searched_curRange = 1; // 검색된 게시글 현재 블럭
                searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);
            }
            for(i=0;i<specified.length;i++) {
                specified[i].addEventListener('click',specifiedBoard);
            }
        
            // 게시글 검색 버튼
            const searchTitleBtn = document.getElementById("search");
            const a = (e) => {
                // 사용자가 검색한 단어
                let searchWord_to_put = document.getElementById("searchWord").value;
                // 제목으로 검색하는지 이름으로 검색하는지
                let searchField = document.getElementById("searchField").value;
                searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);
            }
            searchTitleBtn.addEventListener('click', a);

            // [검색한 게시글] 페이징 버튼
            if(searched_endRange*1>searched_curRange*1){
                console.log("[검색한 게시글] if : 현재 블럭이 마지막 블럭이 아닐 때 (else : 마지막 블럭일 때)");
                if(searched_curRange*1==1){
                    console.log("[검색한 게시글] if : 현재 블럭이 첫번째 블럭일 때 (else : 두번째 블럭에서 마지막 전 블럭까지)");
                    // [검색한 게시글] 처음 페이지로 가기
                    $('#pageCount').append(`<form style="display:inline-block">
                        <button type="button" class="custom-btn btn-16" value="goToFirstPage">
                            <span class="glyphicon glyphicon-fast-backward"></span>
                            <input type="hidden" value="1">
                        </button>
                    </form>`);
                    // [검색한 게시글] 페이지 개수대로 버튼 만들기
                    function pageCount() {
                        for (let i = (searched_curRange-1)*10; i <searched_curRange*10; i++) {
                            $('#pageCount').append(`<form style="display:inline-block">
                                <button type="button" class="custom-btn btn-16" value=${i+1}>${i+1}</button>
                                <input type="hidden" id="curRange" name="curRange" value="${searched_curRange*1}">
                                <input type="hidden" id="curPage" name="curPage" value="${i+1}">
                            </form>`);
                        }
                    }
                    pageCount();
                    // [검색한 게시글] 다음 블럭으로 가기 버튼
                    $('#pageCount').append(`<form style="display:inline-block">
                        <button type="button" class="custom-btn btn-16" value="goToNextPage">
                            <span class="glyphicon glyphicon-chevron-right"></span>
                        </button>
                        <input type="hidden" id="curRange" name="curRange" value="${searched_curRange*1+1}">
                        <input type="hidden" id="curPage" name="curPage" value="${searched_curRange*10+1}">
                    </form>`);
                
                    // [검색한 게시글] 마지막 페이지로 가기
                    $('#pageCount').append(`<form style="display:inline-block">
                        <button type="button" class="custom-btn btn-16" value="goToLastPage">
                            <span class="glyphicon glyphicon-fast-forward"></span>
                        </button>
                        <input type="hidden" id="curRange" name="curRange" value="${Math.ceil(searched_pageCnt/10)}">
                        <input type="hidden" id="curPage" name="curPage" value="${searched_pageCnt}">
                    </form>`);
                }else{
                    console.log("[검색한 게시글] else : 현재 블럭이 두번째 블럭에서 마지막 전 블럭 사이일 때 (if : 첫번째 블럭일 때)");
                    // [검색한 게시글] 처음 페이지로 가기
                    $('#pageCount').append(`<form style="display:inline-block">
                        <button type="button" class="custom-btn btn-16" value="goToFirstPage">
                            <span class="glyphicon glyphicon-fast-backward"></span>
                        </button>
                        <input type="hidden" id="curPage" name="curPage" value="1">
                    </form>`);
                    // [검색한 게시글] 이전 블럭으로 가기 버튼
                    $('#pageCount').append(`<form style="display:inline-block">
                        <button type="button" class="custom-btn btn-16" value="goToPreviousPage">
                            <span class="glyphicon glyphicon-chevron-left"></span>
                        </button>
                        <input type="hidden" id="curRange" name="curRange" value="${searched_curRange*1-1}">
                        <input type="hidden" id="curPage" name="curPage" value="${searched_curRange*10-10}">
                    </form>`);
                    // [검색한 게시글] 페이지 개수대로 버튼 만들기
                    function pageCount() {
                        for (let i = (searched_curRange-1)*10; i <searched_curRange*10; i++) {
                            $('#pageCount').append(`<form style="display:inline-block">
                                <button type="button" class="custom-btn btn-16" value=${i+1}>${i+1}</button>
                                <input type="hidden" id="curRange" name="curRange" value="${searched_curRange*1}">
                                <input type="hidden" id="curPage" name="curPage" value="${i+1}">
                            </form>`);
                        }
                    }
                    pageCount();
                    // [검색한 게시글] 다음 블럭으로 가기 버튼
                    $('#pageCount').append(`<form style="display:inline-block">
                        <button type="button" class="custom-btn btn-16" value="goToNextPage">
                            <span class="glyphicon glyphicon-chevron-right"></span>
                        </button>
                        <input type="hidden" id="curRange" name="curRange" value="${searched_curRange*1+1}">
                        <input type="hidden" id="curPage" name="curPage" value="${searched_curRange*10+1}">
                    </form>`);
            
                    // [검색한 게시글] 마지막 페이지로 가기
                    $('#pageCount').append(`<form style="display:inline-block">
                        <button type="button" class="custom-btn btn-16" value="goToLastPage">
                            <span class="glyphicon glyphicon-fast-forward"></span>
                        </button>
                        <input type="hidden" id="curRange" name="curRange" value="${Math.ceil(searched_pageCnt/10)}">
                        <input type="hidden" id="curPage" name="curPage" value="${searched_pageCnt}">
                    </form>`);
                }
                // [검색한 게시글] 페이징 버튼 생성 및 해당 페이지로 이동 기능 추가
                const curPageBtn = document.querySelectorAll('form>button.custom-btn.btn-16');
                console.log(curPageBtn);
                const showCurPage = (e) => {
                    // [검색한 게시글] 현재 페이지
                    let searched_curPage = $(e.target.childNodes).first().text(); // type : string
                    console.log("searched_curPage: ",searched_curPage);
                    searched_curPage = parseInt(searched_curPage);
                    console.log("searched_curPage: ",searched_curPage);
                    console.log($(e.target));
                    // 페이징 버튼이 '숫자'가 아닌 '이동 버튼'인 경우
                    if(isNaN(parseInt(searched_curPage))){
                        // [검색한 게시글] 처음 페이지로 가기 버튼
                        if($(e.target)[0].outerHTML.includes('fast-backward')){
                        console.log("$(e.target)[0].outerHTML : ",$(e.target)[0].outerHTML);
                            let searched_curPage = 1;
                            searched_curRange = 1;
                            console.log(data);
                            let searched_listCnt = data.length;
                            console.log(searched_listCnt);
                            // 사용자가 검색한 단어
                            let searchWord_to_put = document.getElementById("searchWord").value;
                            // 제목으로 검색하는지 이름으로 검색하는지
                            let searchField = document.getElementById("searchField").value;
                            console.log(searchField);
                            searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);
                        }
                        // [검색한 게시글] 맨 마지막 페이지로 가기 버튼
                        else if ($(e.target)[0].outerHTML.includes('fast-forward')){
                            console.log("$(e.target)[0].outerHTML : ",$(e.target)[0].outerHTML);
                            let searched_curPage = searched_endPage; // [검색한 게시글] 현재 페이지를 마지막 페이지로 넣어주기
                            searched_curRange = searched_endRange;
                            console.log("searched_curPage type: ",typeof(searched_curPage)); // type : number
                            // 사용자가 검색한 단어
                            let searchWord_to_put = document.getElementById("searchWord").value;
                            console.log(searchWord_to_put);
                            // 제목으로 검색하는지 이름으로 검색하는지
                            let searchField = document.getElementById("searchField").value;
                            console.log(searchField);
                            searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);
                        }
                        // [검색한 게시글] 다음 페이지로 가기 버튼
                        else if ($(e.target)[0].outerHTML.includes('chevron-right')){
                            console.log("$(e.target)[0].outerHTML : ",$(e.target)[0].outerHTML);
                            let searched_curPage = searched_curRange*10+1; // [검색한 게시글] 현재 페이지를 다음 블럭의 첫 페이지로
                            searched_curRange = searched_curRange + 1;
                            console.log("searched_curPage type: ",typeof(searched_curPage)); // type : number                            
                            // 사용자가 검색한 단어
                            let searchWord_to_put = document.getElementById("searchWord").value;
                            console.log(searchWord_to_put);
                            // 제목으로 검색하는지 이름으로 검색하는지
                            let searchField = document.getElementById("searchField").value;
                            console.log(searchField);
                            searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);
                        }
                        else {
                            console.log("$(e.target)[0].outerHTML : ",$(e.target)[0].outerHTML);
                            console.log("이전 페이지로 가기");
                            let searched_curPage = (searched_curRange*1-1)*10; // [검색한 게시글] 현재 페이지를 다음 블럭의 첫 페이지로
                            searched_curRange = searched_curRange - 1;
                            console.log("searched_curPage type: ",typeof(searched_curPage)); // type : number                            
                            // 사용자가 검색한 단어
                            let searchWord_to_put = document.getElementById("searchWord").value;
                            console.log(searchWord_to_put);
                            // 제목으로 검색하는지 이름으로 검색하는지
                            let searchField = document.getElementById("searchField").value;
                            console.log(searchField);
                            searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);                            
                        }
                    } else {
                        console.log("페이징 버튼이 숫자인 경우");
                        // 사용자가 검색한 단어
                        let searchWord_to_put = document.getElementById("searchWord").value;
                        // 제목으로 검색하는지 이름으로 검색하는지
                        let searchField = document.getElementById("searchField").value;
                        console.log("searchField: ", searchField);
                        searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);
                    }
                }
                for(let i = 0; i < curPageBtn.length; i++){
                    curPageBtn[i].addEventListener('click', showCurPage);
                }
            } else {
                console.log("[검색한 게시글] else : 현재 블럭이 마지막 블럭일 때 (if : 마지막 블럭이 아닐 때)");
                if (searched_endRange*1==1) {
                    // [검색한 게시글] 처음 페이지로 가기
                    $('#pageCount').append(`<form style="display:inline-block">
                        <button type="button" class="custom-btn btn-16" value="goToFirstPage">
                            <span class="glyphicon glyphicon-fast-backward"></span>
                        </button>
                        <input type="hidden" id="curPage" name="curPage" value="1">
                    </form>`);
                    // [검색한 게시글] 페이지 개수대로 버튼 만들기
                    function pageCount() {
                        for (let i = (searched_curRange-1)*10; i <searched_endPage*1; i++) {
                            $('#pageCount').append(`<form style="display:inline-block">
                                <button type="button" class="custom-btn btn-16" value=${i+1}>${i+1}</button>
                                <input type="hidden" id="curRange" name="curRange" value="${searched_curRange*1}">
                                <input type="hidden" id="curPage" name="curPage" value="${i+1}">
                            </form>`);
                        }
                    }
                    pageCount();
                    // [검색한 게시글] 마지막 페이지로 가기
                    $('#pageCount').append(`<form style="display:inline-block">
                        <button type="submit" class="custom-btn btn-16" value="goToLastPage">
                            <span class="glyphicon glyphicon-fast-forward"></span>
                        </button>
                        <input type="hidden" id="curRange" name="curRange" value="${Math.ceil(searched_pageCnt/10)}">
                        <input type="hidden" id="curPage" name="curPage" value="${searched_pageCnt}">
                    </form>`);
                } else {
                    // [검색한 게시글] 처음 페이지로 가기
                    $('#pageCount').append(`<form style="display:inline-block">
                        <button type="button" class="custom-btn btn-16" value="goToFirstPage">
                            <span class="glyphicon glyphicon-fast-backward"></span>
                        </button>
                        <input type="hidden" id="curPage" name="curPage" value="1">
                    </form>`);
                    // [검색한 게시글] 이전 블럭으로 가기 버튼
                    $('#pageCount').append(`<form style="display:inline-block">
                        <button type="submit" class="custom-btn btn-16" value="goToPreviousPage">
                            <span class="glyphicon glyphicon-chevron-left"></span>
                        </button>
                        <input type="hidden" id="curRange" name="curRange" value="${searched_curRange*1-1}">
                        <input type="hidden" id="curPage" name="curPage" value="${searched_curRange*10-10}">
                    </form>`);
                    // [검색한 게시글] 페이지 개수대로 버튼 만들기
                    function pageCount() {
                        for (let i = (searched_curRange-1)*10; i <searched_endPage*1; i++) {
                            $('#pageCount').append(`<form style="display:inline-block">
                                <button type="button" class="custom-btn btn-16" value=${i+1}>${i+1}</button>
                                <input type="hidden" id="curRange" name="curRange" value="${searched_curRange*1}">
                                <input type="hidden" id="curPage" name="curPage" value="${i+1}">
                            </form>`);
                        }
                    }
                    pageCount();
                    // [검색한 게시글] 마지막 페이지로 가기
                    $('#pageCount').append(`<form style="display:inline-block">
                        <button type="submit" class="custom-btn btn-16" value="goToLastPage">
                            <span class="glyphicon glyphicon-fast-forward"></span>
                        </button>
                        <input type="hidden" id="curRange" name="curRange" value="${Math.ceil(searched_pageCnt/10)}">
                        <input type="hidden" id="curPage" name="curPage" value="${searched_pageCnt}">
                    </form>`);
                }
                const curPageBtn = document.querySelectorAll('form>button.custom-btn.btn-16');
                const showCurPage = (e) => {
                    // [검색한 게시글] 현재 페이지
                    let searched_curPage = $(e.target.childNodes).first().text(); // type : string
                    searched_curPage = parseInt(searched_curPage);
                    console.log("searched_curPage: ",searched_curPage);
                    // [검색한 게시글] 페이징 버튼이 '숫자'가 아닌 '이동 버튼'인 경우
                    if(isNaN(searched_curPage)){
                        // [검색한 게시글] 맨 첫 페이지로 가기 버튼
                        if($(e.target)[0].outerHTML.includes('fast-backward')){
                            console.log("$(e.target)[0].outerHTML : ", $(e.target)[0].outerHTML);
                            let searched_curPage = 1;
                            // 사용자가 검색한 단어
                            let searchWord_to_put = document.getElementById("searchWord").value;
                            // 제목으로 검색하는지 이름으로 검색하는지
                            let searchField = document.getElementById("searchField").value;
                            searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);
                        }
                        // [검색한 게시글] 맨 마지막 페이지로 가기 버튼
                        else if ($(e.target)[0].outerHTML.includes('fast-forward')) { 
                            let searched_curPage = searched_endPage;
                            // 사용자가 검색한 단어
                            let searchWord_to_put = document.getElementById("searchWord").value;
                            // 제목으로 검색하는지 이름으로 검색하는지
                            let searchField = document.getElementById("searchField").value;
                            searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);
                        }
                        // [검색한 게시글] 다음 페이지로 가기 버튼
                        else if ($(e.target)[0].outerHTML.includes('chevron-right')){
                            let searched_curPage = searched_curRange*10+1; // [검색한 게시글] 다음 블럭의 첫 페이지를 현재 페이지에 넣어줌
                            searched_curRange = searched_curRange + 1;
                            // 사용자가 검색한 단어
                            let searchWord_to_put = document.getElementById("searchWord").value;
                            // 제목으로 검색하는지 이름으로 검색하는지
                            let searchField = document.getElementById("searchField").value;
                            searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);
                        }
                        // [검색한 게시글] 이전 페이지로 가기 버튼
                        else {
                            let searched_curPage = (searched_curRange*1-1)*10; // [검색한 게시글] 이전 블럭의 마지막 페이지를 현재 페이지에 넣어줌
                            searched_curRange = searched_curRange - 1;
                            // 사용자가 검색한 단어
                            let searchWord_to_put = document.getElementById("searchWord").value;
                            // 제목으로 검색하는지 이름으로 검색하는지
                            let searchField = document.getElementById("searchField").value;
                            searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);                            
                        }
                    } else {
                        console.log("페이징 버튼이 숫자인 경우");
                        // 사용자가 검색한 단어
                        let searchWord_to_put = document.getElementById("searchWord").value;
                        // 제목으로 검색하는지 이름으로 검색하는지
                        let searchField = document.getElementById("searchField").value;
                        searchTitleJson(searchField, searchWord_to_put, searched_curPage, searched_curRange);
                    }
                }
                for(let i = 0; i < curPageBtn.length; i++){
                    curPageBtn[i].addEventListener('click', showCurPage);
                }
            }
        }

        // [main] 컨트롤러를 활용한 페이징 버튼
        let pageCnt = $('#pageCnt').val(); // 총 페이지 수
        let curRange = $('#curRange').val(); // 현재 블럭
        let curPage = $('#curPage').val(); // 현재 페이지
        let endPage = $('#endPage').val(); // 마지막 페이지
        let endRange = $('#endRange').val(); // 마지막 블럭

        if(endRange*1>curRange*1){
            console.log("현재 블럭이 마지막 블럭이 아닐 때 (else : 마지막 블럭일 때)");
            if(curRange*1==1){
                console.log("현재 블럭이 첫번째 블럭일 때 (else : 두번째 블럭에서 마지막 전 블럭까지)");
                // [main] 처음 페이지로 가기
                $('#pageCount').append(`<form th:action="@{main}" method="get" style="display:inline-block">
                    <button type="submit" class="custom-btn btn-16">
                        <span class="glyphicon glyphicon-fast-backward"></span>
                    </button>
                    <input type="hidden" id="curPage" name="curPage" value="1">
                </form>`);
                // [main] 페이지 개수대로 버튼 만들기
                function pageCount() {
                    for (let i = (curRange-1)*10; i <curRange*10; i++) {
                        $('#pageCount').append(`<form th:action="@{main}" method="get" style="display:inline-block">
                            <button type="submit" class="custom-btn btn-16">${i+1}</button>
                            <input type="hidden" id="curRange" name="curRange" value="${curRange*1}">
                            <input type="hidden" id="curPage" name="curPage" value="${i+1}">
                        </form>`);
                    }
                }
                pageCount();
                // [main] 다음 블럭으로 가기 버튼
                $('#pageCount').append(`<form th:action="@{main}" method="get" style="display:inline-block">
                    <button type="submit" class="custom-btn btn-16">
                        <span class="glyphicon glyphicon-chevron-right"></span>
                    </button>
                    <input type="hidden" id="curRange" name="curRange" value="${curRange*1+1}">
                    <input type="hidden" id="curPage" name="curPage" value="${curRange*10+1}">
                </form>`);
            
                // [main] 마지막 페이지로 가기
                $('#pageCount').append(`<form th:action="@{main}" method="get" style="display:inline-block">
                    <button type="submit" class="custom-btn btn-16">
                        <span class="glyphicon glyphicon-fast-forward"></span>
                    </button>
                    <input type="hidden" id="curRange" name="curRange" value="${Math.ceil(pageCnt/10)}">
                    <input type="hidden" id="curPage" name="curPage" value="${pageCnt}">
                </form>`);
            }else{
                console.log("현재 블럭이 두번째 블럭에서 마지막 전 블럭 사이일 때");
                // [main] 처음 페이지로 가기
                $('#pageCount').append(`<form th:action="@{main}" method="get" style="display:inline-block">
                    <button type="submit" class="custom-btn btn-16">
                        <span class="glyphicon glyphicon-fast-backward"></span>
                    </button>
                    <input type="hidden" id="curPage" name="curPage" value="1">
                </form>`);
                // [main] 이전 블럭으로 가기 버튼
                $('#pageCount').append(`<form th:action="@{main}" method="get" style="display:inline-block">
                    <button type="submit" class="custom-btn btn-16">
                        <span class="glyphicon glyphicon-chevron-left"></span>
                    </button>
                    <input type="hidden" id="curRange" name="curRange" value="${curRange*1-1}">
                    <input type="hidden" id="curPage" name="curPage" value="${curRange*10-10}">
                </form>`);
                // [main] 페이지 개수대로 버튼 만들기
                function pageCount() {
                    for (let i = (curRange-1)*10; i <curRange*10; i++) {
                        $('#pageCount').append(`<form th:action="@{main}" method="get" style="display:inline-block">
                            <button type="submit" class="custom-btn btn-16">${i+1}</button>
                            <input type="hidden" id="curRange" name="curRange" value="${curRange*1}">
                            <input type="hidden" id="curPage" name="curPage" value="${i+1}">
                        </form>`);
                    }
                }
                pageCount();
                // [main] 다음 블럭으로 가기 버튼
                $('#pageCount').append(`<form th:action="@{main}" method="get" style="display:inline-block">
                    <button type="submit" class="custom-btn btn-16">
                        <span class="glyphicon glyphicon-chevron-right"></span>
                    </button>
                    <input type="hidden" id="curRange" name="curRange" value="${curRange*1+1}">
                    <input type="hidden" id="curPage" name="curPage" value="${curRange*10+1}">
                </form>`);
        
                // [main] 마지막 페이지로 가기
                $('#pageCount').append(`<form th:action="@{main}" method="get" style="display:inline-block">
                    <button type="submit" class="custom-btn btn-16">
                        <span class="glyphicon glyphicon-fast-forward"></span>
                    </button>
                    <input type="hidden" id="curRange" name="curRange" value="${Math.ceil(pageCnt/10)}">
                    <input type="hidden" id="curPage" name="curPage" value="${pageCnt}">
                </form>`);
            }
        } else {
            console.log("현재 블럭이 마지막 블럭일 때");
            // [main] 처음 페이지로 가기
            $('#pageCount').append(`<form th:action="@{main}" method="get" style="display:inline-block">
                <button type="submit" class="custom-btn btn-16">
                    <span class="glyphicon glyphicon-fast-backward"></span>
                </button>
                <input type="hidden" id="curPage" name="curPage" value="1">
            </form>`);
            // [main] 이전 블럭으로 가기 버튼
            $('#pageCount').append(`<form th:action="@{main}" method="get" style="display:inline-block">
                <button type="submit" class="custom-btn btn-16">
                    <span class="glyphicon glyphicon-chevron-left"></span>
                </button>
                <input type="hidden" id="curRange" name="curRange" value="${curRange*1-1}">
                <input type="hidden" id="curPage" name="curPage" value="${curRange*10-10}">
            </form>`);
            // [main] 페이지 개수대로 버튼 만들기
            function pageCount() {
                for (let i = (curRange-1)*10; i <endPage*1; i++) {
                    $('#pageCount').append(`<form th:action="@{main}" method="get" style="display:inline-block">
                        <button type="submit" class="custom-btn btn-16">${i+1}</button>
                        <input type="hidden" id="curRange" name="curRange" value="${curRange*1}">
                        <input type="hidden" id="curPage" name="curPage" value="${i+1}">
                    </form>`);
                }
            }
            pageCount();
            // [main] 마지막 페이지로 가기
            $('#pageCount').append(`<form th:action="@{main}" method="get" style="display:inline-block">
                <button type="submit" class="custom-btn btn-16">
                    <span class="glyphicon glyphicon-fast-forward"></span>
                </button>
                <input type="hidden" id="curRange" name="curRange" value="${Math.ceil(pageCnt/10)}">
                <input type="hidden" id="curPage" name="curPage" value="${pageCnt}">
            </form>`);
        }
    </script>
</html>